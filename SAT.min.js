/*
 SAT.js - Version 0.7.1 - Copyright 2012 - 2018 - Jim Riecken <jimr@jimr.ca> - released under the MIT License. https://github.com/jriecken/sat-js */
(function(b,q){"function"===typeof define&&define.amd?define(q):"object"===typeof exports?module.exports=q():b.SAT=q()})(this,function(){function b(a,d){this.x=a||0;this.y=d||0}function q(a,d){this.pos=a||new b;this.r=d||0;this.offset=new b}function f(a,d){this.pos=a||new b;this.angle=0;this.offset=new b;this.setPoints(d||[])}function t(a,d,c){this.pos=a||new b;this.w=d||0;this.h=c||0}function x(){this.b=this.a=null;this.overlapN=new b;this.overlapV=new b;this.clear()}function B(a,d,c){for(var l=
Number.MAX_VALUE,b=-Number.MAX_VALUE,h=a.length,g=0;g<h;g++){var e=a[g].dot(d);e<l&&(l=e);e>b&&(b=e)}c[0]=l;c[1]=b}function y(a,d,c,l,b,h){var g=r.pop(),e=r.pop();a=k.pop().copy(d).sub(a);d=a.dot(b);B(c,b,g);B(l,b,e);e[0]+=d;e[1]+=d;if(g[0]>e[1]||e[0]>g[1])return k.push(a),r.push(g),r.push(e),!0;h&&(g[0]<e[0]?(h.aInB=!1,g[1]<e[1]?(c=g[1]-e[0],h.bInA=!1):(c=g[1]-e[0],l=e[1]-g[0],c=c<l?c:-l)):(h.bInA=!1,g[1]>e[1]?(c=g[0]-e[1],h.aInB=!1):(c=g[1]-e[0],l=e[1]-g[0],c=c<l?c:-l)),l=Math.abs(c),l<h.overlap&&
(h.overlap=l,h.overlapN.copy(b),0>c&&h.overlapN.reverse()));k.push(a);r.push(g);r.push(e);return!1}function z(a,d){var c=a.len2(),b=d.dot(a);return 0>b?-1:b>c?1:0}function C(a,d,c){for(var b=k.pop().copy(d.pos).add(d.offset).sub(a.pos),m=d.r,h=m*m,g=a.calcPoints,e=g.length,u=k.pop(),f=k.pop(),n=0;n<e;n++){var v=n===e-1?0:n+1,q=0===n?e-1:n-1,r=0,t=null;u.copy(a.edges[n]);f.copy(b).sub(g[n]);c&&f.len2()>h&&(c.aInB=!1);var p=z(u,f);if(-1===p){u.copy(a.edges[q]);v=k.pop().copy(b).sub(g[q]);p=z(u,v);if(1===
p){p=f.len();if(p>m)return k.push(b),k.push(u),k.push(f),k.push(v),!1;c&&(c.bInA=!1,t=f.normalize(),r=m-p)}k.push(v)}else if(1===p){if(u.copy(a.edges[v]),f.copy(b).sub(g[v]),p=z(u,f),-1===p){p=f.len();if(p>m)return k.push(b),k.push(u),k.push(f),!1;c&&(c.bInA=!1,t=f.normalize(),r=m-p)}}else{v=u.perp().normalize();p=f.dot(v);q=Math.abs(p);if(0<p&&q>m)return k.push(b),k.push(v),k.push(f),!1;c&&(t=v,r=m-p,0<=p||r<2*m)&&(c.bInA=!1)}t&&c&&Math.abs(r)<Math.abs(c.overlap)&&(c.overlap=r,c.overlapN.copy(t))}c&&
(c.a=a,c.b=d,c.overlapV.copy(c.overlapN).scale(c.overlap));k.push(b);k.push(u);k.push(f);return!0}function D(a,d,c){for(var b=a.calcPoints,m=b.length,h=d.calcPoints,g=h.length,e=0;e<m;e++)if(y(a.pos,d.pos,b,h,a.normals[e],c))return!1;for(e=0;e<g;e++)if(y(a.pos,d.pos,b,h,d.normals[e],c))return!1;c&&(c.a=a,c.b=d,c.overlapV.copy(c.overlapN).scale(c.overlap));return!0}var n={};n.Vector=b;n.V=b;b.prototype.copy=b.prototype.copy=function(a){this.x=a.x;this.y=a.y;return this};b.prototype.clone=b.prototype.clone=
function(){return new b(this.x,this.y)};b.prototype.perp=b.prototype.perp=function(){var a=this.x;this.x=this.y;this.y=-a;return this};b.prototype.rotate=b.prototype.rotate=function(a){var d=this.x,c=this.y;this.x=d*Math.cos(a)-c*Math.sin(a);this.y=d*Math.sin(a)+c*Math.cos(a);return this};b.prototype.reverse=b.prototype.reverse=function(){this.x=-this.x;this.y=-this.y;return this};b.prototype.normalize=b.prototype.normalize=function(){var a=this.len();0<a&&(this.x/=a,this.y/=a);return this};b.prototype.add=
b.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};b.prototype.sub=b.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};b.prototype.scale=b.prototype.scale=function(a,d){this.x*=a;this.y*="undefined"!=typeof d?d:a;return this};b.prototype.project=b.prototype.project=function(a){var d=this.dot(a)/a.len2();this.x=d*a.x;this.y=d*a.y;return this};b.prototype.projectN=b.prototype.projectN=function(a){var d=this.dot(a);this.x=d*a.x;this.y=d*a.y;return this};b.prototype.reflect=
b.prototype.reflect=function(a){var d=this.x,c=this.y;this.project(a).scale(2);this.x-=d;this.y-=c;return this};b.prototype.reflectN=b.prototype.reflectN=function(a){var d=this.x,c=this.y;this.projectN(a).scale(2);this.x-=d;this.y-=c;return this};b.prototype.dot=b.prototype.dot=function(a){return this.x*a.x+this.y*a.y};b.prototype.len2=b.prototype.len2=function(){return this.dot(this)};b.prototype.len=b.prototype.len=function(){return Math.sqrt(this.len2())};n.Circle=q;q.prototype.getAABB=q.prototype.getAABB=
function(){var a=this.r,d=this.pos.clone().add(this.offset).sub(new b(a,a));return(new t(d,2*a,2*a)).toPolygon()};q.prototype.setOffset=q.prototype.setOffset=function(a){this.offset=a;return this};n.Polygon=f;f.prototype.setPoints=f.prototype.setPoints=function(a){if(!this.points||this.points.length!==a.length){var d,c=this.calcPoints=[],l=this.edges=[],m=this.normals=[];for(d=0;d<a.length;d++)c.push(new b),l.push(new b),m.push(new b)}this.points=a;this._recalc();return this};f.prototype.setAngle=
f.prototype.setAngle=function(a){this.angle=a;this._recalc();return this};f.prototype.setOffset=f.prototype.setOffset=function(a){this.offset=a;this._recalc();return this};f.prototype.rotate=f.prototype.rotate=function(a){for(var d=this.points,c=d.length,b=0;b<c;b++)d[b].rotate(a);this._recalc();return this};f.prototype.translate=f.prototype.translate=function(a,b){for(var c=this.points,d=c.length,m=0;m<d;m++)c[m].x+=a,c[m].y+=b;this._recalc();return this};f.prototype._recalc=function(){var a=this.calcPoints,
b=this.edges,c=this.normals,l=this.points,m=this.offset,h=this.angle,g=l.length,e;for(e=0;e<g;e++){var f=a[e].copy(l[e]);f.x+=m.x;f.y+=m.y;0!==h&&f.rotate(h)}for(e=0;e<g;e++)l=a[e],l=b[e].copy(e<g-1?a[e+1]:a[0]).sub(l),c[e].copy(l).perp().normalize();return this};f.prototype.getAABB=f.prototype.getAABB=function(){for(var a=this.calcPoints,d=a.length,c=a[0].x,l=a[0].y,f=a[0].x,h=a[0].y,g=1;g<d;g++){var e=a[g];e.x<c?c=e.x:e.x>f&&(f=e.x);e.y<l?l=e.y:e.y>h&&(h=e.y)}return(new t(this.pos.clone().add(new b(c,
l)),f-c,h-l)).toPolygon()};f.prototype.getCentroid=f.prototype.getCentroid=function(){for(var a=this.calcPoints,d=a.length,c=0,f=0,m=0,h=0;h<d;h++){var g=a[h],e=h===d-1?a[0]:a[h+1],k=g.x*e.y-e.x*g.y;c+=(g.x+e.x)*k;f+=(g.y+e.y)*k;m+=k}m*=3;return new b(c/m,f/m)};n.Box=t;t.prototype.toPolygon=t.prototype.toPolygon=function(){var a=this.pos,d=this.w,c=this.h;return new f(new b(a.x,a.y),[new b,new b(d,0),new b(d,c),new b(0,c)])};n.Response=x;x.prototype.clear=x.prototype.clear=function(){this.bInA=this.aInB=
!0;this.overlap=Number.MAX_VALUE;return this};for(var k=[],w=0;10>w;w++)k.push(new b);var r=[];for(w=0;5>w;w++)r.push([]);var A=new x,E=(new t(new b,1E-6,1E-6)).toPolygon();n.isSeparatingAxis=y;n.pointInCircle=function(a,b){var c=k.pop().copy(a).sub(b.pos).sub(b.offset),d=b.r*b.r,f=c.len2();k.push(c);return f<=d};n.pointInPolygon=function(a,b){E.pos.copy(a);A.clear();var c=D(E,b,A);c&&(c=A.aInB);return c};n.testCircleCircle=function(a,b,c){var d=k.pop().copy(b.pos).add(b.offset).sub(a.pos).sub(a.offset),
f=a.r+b.r,h=f*f,g=d.len2();if(g>h)return k.push(d),!1;c&&(h=Math.sqrt(g),c.a=a,c.b=b,c.overlap=f-h,c.overlapN.copy(d.normalize()),c.overlapV.copy(d).scale(c.overlap),c.aInB=a.r<=b.r&&h<=b.r-a.r,c.bInA=b.r<=a.r&&h<=a.r-b.r);k.push(d);return!0};n.testPolygonCircle=C;n.testCirclePolygon=function(a,b,c){if((a=C(b,a,c))&&c){b=c.a;var d=c.aInB;c.overlapN.reverse();c.overlapV.reverse();c.a=c.b;c.b=b;c.aInB=c.bInA;c.bInA=d}return a};n.testPolygonPolygon=D;return n});
